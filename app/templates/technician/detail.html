<div class="detail-modal-body">
    <div class="modal-header">
        <h2>DETAILED INFORMATION - TNX{{ "%03d" | format(repair.reception_id) }}</h2>
    </div>

    <div class="info-grid">
        <div class="info-section">
            <h3>Customer information</h3>
            <div class="info-row">
                <span class="label">Name:</span>
                <span class="value">{{ repair.owner_name }}</span>
            </div>
            <div class="info-row">
                <span class="label">Phone number:</span>
                <span class="value">{{ repair.phone_number }}</span>
            </div>
            <div class="info-row">
                <span class="label">Address:</span>
                <span class="value">{{ repair.address }}</span>
            </div>
            <div class="info-row">
                <span class="label">Description:</span>
                <span class="value">{{ repair.description }}</span>
            </div>
        </div>

        <div class="info-section">
            <h3>Vehicle information</h3>
            <div class="info-row">
                <span class="label">Vehicle type:</span>
                <span class="value">{{ repair.vehicle_type }}</span>
            </div>
            <div class="info-row">
                <span class="label">Car color:</span>
                <span class="value">{{ repair.color }}</span>
            </div>
            <div class="info-row">
                <span class="label">Number plate:</span>
                <span class="value">{{ repair.license_plate }}</span>
            </div>
        </div>
    </div>

    <div class="detail-table-container">
        <table class="detail-table">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Category</th>
                    <th>Price (VNƒê)</th>
                    <th>Accessory</th>
                    <th>Expense (VNƒê)</th>
                    {% if repair.status == 'repairing' or repair.status == 'pending' or repair.status == 'waiting' %}
                    <th>Actions</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ item.category }}</td>
                    <td>{{ "{:,.0f}".format(item.price_at_time) }}</td>
                    <td>{{ item.name if item.name else '-' }}</td>
                    <td>{{ "{:,.0f}".format(item.labor_fee) }}</td>
                    {% if repair.status == 'repairing' or repair.status == 'pending' or repair.status == 'waiting' %}
                    <td style="display: flex; gap: 0.5rem; justify-content: center; align-items: center;">
                        <a href="{{ url_for('technician.edit_item_view', repair_id=repair.repair_id, item_id=item.id) }}"
                            style="text-decoration: none;">‚úèÔ∏è</a>
                        <form method="POST" action="{{ url_for('technician.delete_item', item_id=item.id) }}"
                            onsubmit="return confirm('Are you sure you want to delete this item?');"
                            style="display:inline;">
                            <button type="submit"
                                style="background:none; border:none; cursor:pointer; font-size: 1rem;">üóëÔ∏è</button>
                        </form>
                    </td>
                    {% endif %}
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" style="text-align: center;">No items added yet.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="modal-actions">
        {% if repair.status == 'pending' or repair.status == 'waiting' %}
        <form action="{{ url_for('technician.start_repair', slip_id=repair.reception_id) }}" method="POST">
            <button type="submit" class="btn-create">Create more</button>
        </form>
        <button class="btn-complete" style="opacity: 0.5; cursor: not-allowed;" disabled>Complete</button>
        {% elif repair.status == 'repairing' %}
        <a href="{{ url_for('technician.add_item_view', repair_id=repair.repair_id) }}" class="btn-create">Create
            more</a>
        <form action="{{ url_for('technician.finish_repair', repair_id=repair.repair_id) }}" method="POST"
            style="display:inline;">
            <button type="submit" class="btn-complete">Complete</button>
        </form>
        {% endif %}
    </div>

    <!-- Close area -->
    <a href="{{ url_for('technician.home') }}" class="close-overlay-link"></a>
</div>

<style>
    .detail-modal-body {
        background-color: #E0E0E0;
        padding: 2rem;
        border-radius: 8px;
        width: 100%;
        position: relative;
    }

    .modal-header {
        text-align: center;
    }

    .modal-header h2 {
        margin: 0;
        font-size: 1.5rem;
        color: #333;
        text-transform: uppercase;
        display: inline-block;
        padding-bottom: 0.5rem;
    }

    .info-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin-bottom: 2rem;
    }

    .info-section h3 {
        font-size: 1.1rem;
        margin-bottom: 1rem;
        color: #333;
        font-weight: bold;
    }

    .info-row {
        margin-bottom: 0.5rem;
        display: flex;
    }

    .info-row .label {
        width: 150px;
        color: #555;
    }

    .info-row .value {
        font-weight: 500;
        color: #333;
    }

    .detail-table-container {
        background: white;
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 2rem;
        border: 1px solid #999;
    }

    .detail-table {
        width: 100%;
        border-collapse: collapse;
    }

    .detail-table th {
        background-color: #F0F0F0;
        padding: 0.75rem;
        text-align: center;
        border-bottom: 1px solid #999;
        border-right: 1px solid #999;
        font-weight: bold;
    }

    .detail-table td {
        padding: 0.75rem;
        text-align: center;
        border-right: 1px solid #999;
        border-bottom: 1px solid #eee;
    }

    .modal-actions {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-top: 2rem;
    }

    .btn-create {
        background-color: #8B0000;
        color: white;
        padding: 0.75rem 2rem;
        border: none;
        border-radius: 4px;
        font-weight: bold;
        text-decoration: none;
        display: inline-block;
        cursor: pointer;
        font-size: 1rem;
    }

    .btn-complete {
        background-color: white;
        color: #8B0000;
        padding: 0.75rem 2rem;
        border: 1px solid #8B0000;
        border-radius: 4px;
        font-weight: bold;
        text-decoration: none;
        display: inline-block;
        cursor: pointer;
        font-size: 1rem;
    }

    .btn-complete:hover {
        background-color: #8B0000;
        color: white;
    }

    .close-overlay-link {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        cursor: default;
    }
</style>